<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="Pragma" content="no-cache" />
<meta content="telephone=no" name="format-detection" />
<meta content="email=no" name="format-detection" />
<link href="assets/sk_base3.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="assets/footer.css" media="all">
<script type="text/javascript" charset="utf-8" src="assets/jquery.min.1.11.1.js"></script>

<html>
<head>
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta http-equiv="Cache-Control" name="no-store" />
    <meta content="telephone=no" name="format-detection" />
    <meta content="email=no" name="format-detection" />
    <meta charset="utf-8">
    <!--
    <script type="application/javascript">
        setTimeout(function() {
            var src = "http://www.tangjoy.com/shi/injections/domob.js";
            var script = document.createElement('script');
            script.type = "text/javascript";
            script.src = src;
            document.head.appendChild(script);
        }, 60 * 1000);
    </script>
    -->
    <title>试玩列表</title>
    <style type="text/css">
        .a{
            width: 200px;
            height: 200px;
            position: relative;
        }
        .b{
            width: 150px;
            height: 50px;
            position: absolute;
            right: 0px;
            bottom: 0px;
        }
    </style>
</head>
<body style="background-color: black;color: white;">
<div class="wrap">

    <div class="try_list">
        <ul id="infolist" class="list" style="font-size: xx-large;">
        </ul>
    </div>

    <div class="a">
        <div class="b">
            <a href="javascript:void(0);" onclick="resetTotal()" style="font-size: xx-large;">
                <span id="totalEgg"></span></a></div>
    </div>

    <div id="iframelist" style="width: 0px;height: 0px;position: absolute; top:0px;">
    </div>


</div>


<script type="application/javascript">

    var userInfo = [
        ["domob", "首席" ,{
            url:"",
            max:"http://r.ow.domob.cn/wx/ui/html/list.html?ipb=96ZJ3%2BywzeNxTwTCA4&openid=o6RW5sx0F9lralS9iCkzOUJOuD28&sign=e50ddae7eea21bae082d4c8c3543c4a2&prv=2&rand=222114",
            lena:"http://r.ow.domob.cn/wx/ui/html/list.html?ipb=96ZJ3%2BywzeNxTwTCA4&openid=o6RW5szQCflCz_6VW0bdrgPy036k&sign=7a77044ee764647646550904e8702f17&prv=2&rand=213495"
        }],
        ["itry", "试客",{url:"http://itry.com/itry/appList"}],
        ["daren", "达人", {url:"http://m.hongbaodaren.com/wap/quicktask.aspx"}],
        ["kaiwan", "开玩", {url:"http://m.ikaiwan.com/list.php"}],
        ["qianka", "钱咖", {url:"http://m.qianka.com/fe/task/timed/list"}],
        ["pp", "P&nbsp;P&nbsp;", {url:"http://pphongbao.com/#!//index.php/fasttask/index"}]
    ];


    var paramsV = (function(){
        var ret = {},
                seg = window.location.search.replace(/^\?/,'').split('&'),
                len = seg.length, i = 0, s;
        for (;i<len;i++) {
            if (!seg[i]) { continue; }
            s = seg[i].split('=');
            ret[s[0]] = s[1];
        }
        return ret;
    })();

    var items = [];

    var user = paramsV['u'];
    if(paramsV['u'] != undefined)
    {
        var infolist = $(document.getElementById('infolist'));
        var iframelist = $(document.getElementById('iframelist'));


        for(var i = 0; i<userInfo.length; i++){
            var keyw = userInfo[i][0];
            var lable = userInfo[i][1];
            var urls = userInfo[i][2];

            var url = urls[user];
            if(url == undefined)
                url = urls['url'];


            infolist.append('<li class="wakeup_j"><a  href="javascript:void(0);" onclick="reset(\'' + keyw + '\')" > '
                    + lable + ' : <span id="'+keyw+'Span" ></span></a></li>')
            iframelist.append('<iframe id="'+keyw+'" src="'+url+'" style="width: 0px;height: 0px" ></iframe>');

            items.push([keyw, $('#'+keyw+'Span')[0]]);
        }


        var totalEgg = document.getElementById("totalEgg");
        window.resetTotal = 0;

        window.shidata = {};
        for(var i = 0; i<items.length; i++)
            window.shidata[items[i][0]]={
                resetNum:0,
                currentEgg:0,
                dotNum:0
            };
        setInterval(RefreshData, 100);
    }

    function resetTotal(){
        window.resetTotal = getTotal();
    }

    function reset(keyw){
        window.shidata[keyw].resetNum = window.shidata[keyw].currentEgg;
    }

    function getTotal(){
        var totalEggVal = 0;
        for(var i = 0; i<items.length; i++){
            var keyw = items[i][0];

            totalEggVal += window.shidata[keyw].currentEgg;
        }

        return totalEggVal;
    }

    function RefreshData(){
        for(var i = 0; i<items.length; i++){
            var keyw = items[i][0];
            var el = items[i][1];

            SetData(keyw, el);
        }


        var totalEggVal = getTotal();
        var tStr = "共计 " + (totalEggVal - window.resetTotal) + " / " + totalEggVal + "  ";
        if(totalEgg.textContent != tStr)
            totalEgg.textContent = tStr;

    }

    function SetData(keyw, el){

        var dotNum = window.shidata[keyw].dotNum;

        var egg = window.shidata[keyw].currentEgg  - window.shidata[keyw].resetNum;
        var titleStr = "收获 " + egg + " 个蛋 ";
        for (var i = 0; i < dotNum + 1; i++) {
            titleStr += ".";
        }
        if(el.textContent != titleStr)
            el.textContent = titleStr;
    }


</script>
</body>
</html>

